# OMS 파트너사 중간 시연회 회의록

## 2020-05-19 10:00





### 1. OMS 시스템 개요

최석영 전무 발표



- 아키텍쳐

OMS 서버안에서 비클 매니저에 AI 탑재

메시지 매니저 - 비클과 비클매니저간 MQTT를 오고가게 하기 위한 매니저

OMS DB에 메시지 매니저의 매시지가 저장됨 비클 매니저로 가고 매시지 매니저로 감 계속 반복

- 장점

AI 기반 routing 및 dispatching** 으로 반송시간 효율향상

**Event 기반 MQTT 통신**으로 대형 시스템 scale up 지원

**Time series data** 제공으로 KPI 및 빅데이터 분석 지원 (추후 빅데이터 분석 가능)

**모듈**화를 통한 시스템 부하 분산 지원 (추후 메시지 매니저 병렬 가능)

![image-20200519100622998](C:\Users\SFC202003005\AppData\Roaming\Typora\typora-user-images\image-20200519100622998.png)

### 2. OMS 기능 시연
   - OMS 운영 프로세스
   - 시연 대상 기능

맵에디터 시연 영상을 보여줌

- 제이슨 파일 형태로 저장
- 특정 OMS 명령어로 UI 맵을 불러옴
- UI 상에서 CYCLE-TEST 기능 탑재 
  - 사이클 파일 저장 가능
  - move/from/to 사이클
  - 시간 설정 가능
  - 즉석 플레이 가능
  - UI를 통한 사이클 기능 단순화
- OMS 소프트웨어 업데이트해도 중간지점부터 지속적으로 운영가능(DB 유지)
- E-STOP 후 리셋 후 이니셜라이즈(오토) 후 명령 지속적으로 진행 가능
- PUSH - 1차 비클 푸쉬 후 2차 비클 푸쉬가 아닌, 모든 비클이 미리 푸쉬되어 경로이동에 지장이 없도록함.
- 모바일 기능 구현
  - 가시화를 위해 TRACK 기능 구현

### 3. 250대 시연
   - 250대 주행 시연 (layout UI)
   - NETDATA를 통해 시스템 오버뷰 가능(CPU, KPI 등)
   - 초록색줄은 from스테이션, 파란색줄은 to스테이션
   - 컨트롤 메뉴
        - 오더스 : 비클에 오더 할당하는 기능
        - 비클 : 비클에 이스탑 
        - 테스트 : 사이클테스트
        - 서버 : 매니저 관리
   - 각 메뉴 설명
   - 하드웨어 사양 설명
   - 



### 4. 250대 주행 결과
   - Automod와 결과 비교
        - 하루처리 오더수 대비 평균반송시간 성능에서 약 90% 성능을 보여줌
   - 평균반송시간 추이
        - AI 기능으로 시간을 줄임
   - 이상주행 현황 및 방안
        - AI 기능으로 개선이 안되고 반복 주행을 할때, 최단경로 선택을 하도록 적용 예정
        - 정체가 해소되면 Q값을 낮춰주는 알고리즘 적용 예정



### 5. 500대 주행 준비

● iteration 속도 유지를 위한 연산 최적화

​	○ 연산 분산: multi-process

​	○ 중복 연산 최적화

● 500대 주행을 위한 서버 사양

​	○ CPU: 물리 코어 16 (논리 코어 32)

​	○ 64G 메모리

​	○ dual ethernet

### 6. OMS 진행현황 (5월 위주)

- 이상징후 알고리즘( q복원 알고리즘) 지속 개발 예정
- 분산배치 알고리즘 - 오더에 대한 비클의 효율적인 배치 지속 개발 예정
- Server Managermnet UI
- 패키징 - CentOS, obfuscate(코드 숨김 위함)
- Playback - 다음 품평회 때 개선 후 보여줌
- 250대 및 500대 주행에 대한 분할 및 최적화 진행



### 7. 질문

- 푸쉬 기능에 대한 다익스트라 vs AI (예상 주행경로에 대한 비효율성 발생 가능성, 판단 기준 개선 요망),
- Map의 속도
- 푸쉬 당하면서 q값이 변하지 않나?
  - 포인트를 지날 때마다 q값이 업데이트 되진않고, 포인트 서브그룹인 vertax라는 구간에서 q값이 업데이트 된다.
- 6월 완료 예정 기준, 고객 앞에서 시연 해서 검증하길 요망
- MCS와 연계해서 검증계획 있으신가요? (Automod와 성능 비교)
  - OMS 주행로직을 바꾼후 확인해보겠다.
  - MCS에서 보내는 메세지속도는 실제 가동 속도에 큰 영향을 끼치진 않는다.  내부 Iteration 속도가 더 중요.
- 전체 가동률 계산식 시간 질문
  - 기준을 다르게함. 24시간 vs 48시간
- OMS와 Automod와 비교 가능 한가요?
  - LOG로 비교분석을 해야 하는 상황
- UI 실행시 CPU 점유율 (20% * 5), 1PC에서 5개 못 띄우나요? 
  - 못 띄움
- 멀티프로세스 아이디어
  - 파이썬의 핸디캡
- UI 작동 로그도 필요하다고 봄 (조작할 때 생기는 미스를 파악하기 위함)
  - 로그인/아웃 시간 및 작업내용 로그 필요
- 프로그램 종료 시 Q값 유지 되나요? 
  - 비클매니저 꺼지면 파일 자동저장, 추후 1시간 씩 자동저장 예정, 불러올때 시간이 많이걸림
- 하드웨어 사양
  - 10대는 일반피시로 가능함
  - 웹브라우저는 크롬만 됨
  - 고객사에서 설치 못하는 상황이 생김. 범용 쪽으로 사용하지 못함. 호환성 필요
    - 추후 개선시간이 필요
- 여러가지 센서데이터를 어떻게 받을 수 잇냐?
  - MQTT기반이기 때문에 편하게 가능하다.
  - 인터페이스 추가 개발 요망
- MTL - PLC 간 통신에서 문제점 - PLC 리눅스 지원 안 함.
- OMS-MQTT 간 통신할때 메세지가 누락되면 처리가 어떻게되냐?
  - 메세지양 부하 및 통신 끊김 상황
  - 메세지양 부하되면, 매니저에서 병렬로 보내면 됨
  - 모든 케이스를 가지고 반영하려고 노력 중에 있음. 현장가서 추가 보수 필요하다고 판단.
- 맵에디터 DB가 없는 경우 어떻게 하냐?
  - oms-config 명령을 하면 DB 인터페이스까지 다 생성하기 때문에 문제 없다.
  - OMS 에서 쓰는 거와 비클에서 쓰는 건 다르다.
- 250대 운영 화면에서 1대 운행만 보여달라
  - PAUSE 기능이 없음.
  - E-STOP만 됨.
- 오더가 줄면, 성능 차이도 줄어드냐?(automod vs oms)
  - 그렇다.
- 특정구간에 비클 대 수를 제한할수 있냐?
  - clustering 기능으로 가능함
- 특정 비클의 우선순위는 정할수있냐?
  - 비클은 우선순위가 없지만, 오더는 우선순위가 있다.
  - 아이들 비클이 많이 남기 때문에,  필요성이 없다고 본다.
- 루프도는 부분 해결 되었나?